<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
	<head>
		<meta http-equiv="content-type" content="text/html; charset=utf-8" />
		<meta name="generator" content="JsDoc Toolkit" />
		<title>DecafMUD Reference - decafmud.storage.standard.js</title>
		<link href="../../css/default.css" type="text/css" rel="stylesheet" media="all" />
		<link href="../../css/shCoreDefault.css" type="text/css" rel="stylesheet" media="all" />
		<link href="../../css/shThemeDefault.css" type="text/css" rel="stylesheet" media="all" />
        <link href="../../img/favicon.ico" rel="shortcut icon" />
		<script type="text/javascript" src="../../js/shCore.js"></script>
		<script type="text/javascript" src="../../js/shBrushJScript.js"></script>
	</head>

	<body>
		<div id="header">
    <h1><a href="http://decafmud.stendec.me/">DecafMUD</a></h1>
    <p class="paren">{</p>
    <p>HTML + CSS + JavaScript</p>
    <p class="paren last-paren">}</p>
    <p>keep Java away from your browser</p>
    <div style="clear:both"></div>
</div>

		<div class="index">
			<div class="menu">
				<!-- begin publish.classesIndex -->
				<div align="center"><a href="../../index.html">Class Index</a> | <a href="../../files.html">File Index</a></div>

<h2 class="heading1">Classes</h2>

<ul class="classList">
	<li class="namespace builtin"><a href="../../symbols/_global_.html">_global_</a></li><li class="class"><a href="../../symbols/DecafMUD.html">DecafMUD</a></li><li class="namespace">&nbsp;&nbsp;&nbsp;&nbsp;<a href="../../symbols/DecafMUD.plugins.html">.plugins</a></li><li class="nolink">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.Display</li><li class="class">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="../../symbols/DecafMUD.plugins.Display.standard.html">.standard</a></li><li class="nolink">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.Encoding</li><li class="namespace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="../../symbols/DecafMUD.plugins.Encoding.cp437.html">.cp437</a></li><li class="namespace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="../../symbols/DecafMUD.plugins.Encoding.iso88591.html">.iso88591</a></li><li class="namespace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="../../symbols/DecafMUD.plugins.Encoding.iso885915.html">.iso885915</a></li><li class="namespace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="../../symbols/DecafMUD.plugins.Encoding.utf8.html">.utf8</a></li><li class="nolink">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.Interface</li><li class="class">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="../../symbols/DecafMUD.plugins.Interface.simple.html">.simple</a></li><li class="nolink">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.Socket</li><li class="class">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="../../symbols/DecafMUD.plugins.Socket.websocket.html">.websocket</a></li><li class="nolink">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.Storage</li><li class="class">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="../../symbols/DecafMUD.plugins.Storage.standard.html">.standard</a></li><li class="nolink">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.Telopt</li><li class="class">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DecafMUD.plugins.Telopt.]</li><li class="class">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DecafMUD.plugins.Telopt.ï¿½</li><li class="namespace builtin"><a href="../../symbols/String.html">String</a></li>
</ul>

				<!-- end publish.classesIndex -->
			</div>
			
			<div class="fineprint" style="clear:both">
				
				Generated by <a href="http://code.google.com/p/jsdoc-toolkit/" target="_blank">JsDoc Toolkit</a> 2.4.0<br />
				HTML template: <a href="http://www.thebrightlines.com/2010/05/06/new-template-for-jsdoctoolkit-codeview/" target="_blank">Codeview</a><br />
				<a href="http://decafmud.stendec.me/">DecafMUD</a> &copy; 2010 Stendec
			</div>
		</div>
		
		<div class="content" style="max-width: none">
			<div class="innerContent">
				<h1 class="classTitle">Source <span>decafmud.storage.standard.js</span></h1>
				
				<p class="description summary">
					<em>File: </em> /mud/decafmud/src/js/decafmud.storage.standard.js
				</p>
				
				<div class="details props">
					<div class="innerProps">
						<a name="source"></a>
						
						<div class="sectionTitle">
							Hilighted Source
						</div>
						
						<pre class="brush: js; toolbar: false">/*!
 * DecafMUD v0.9.0
 * http://decafmud.stendec.me
 *
 * Copyright 2010, Stendec &lt;me@stendec.me>
 */

/**
 * @fileOverview DecafMUD Storage Provider: Standard
 * @author Stendec &lt;me@stendec.me>
 * @version 0.9.0
 */

(function(DecafMUD) {

/** &lt;p>This is a storage provider for DecafMUD that users localStorage to provide
 *  storage for the client that persists across browser sessions.&lt;/p>
 *  &lt;p>Alternatively, if this is called on an instance of itself, it can be used
 *  to make sub-objects for plugin-specific setting separation. That's done
 *  internally though.&lt;/p>
 * @name Storage
 * @class DecafMUD Storage Provider: Standard
 * @exports Storage as DecafMUD.plugins.Storage.standard
 * @param {DecafMUD} decaf The instance of DecafMUD using this plugin instance. */
var Storage = function(decaf,path) {
	// Handle the path. It defaults to '/' if we don't have any other name.
	if ( path === undefined ) { path = ''; }
	this.path = path+'/';
	
	// Were we handed a Storage?
	if ( decaf instanceof Storage ) {
		// Get Decaf from our parent.
		this.decaf = decaf.decaf;
		
		// Also push this onto our parent while we're at it.
		decaf.children.push(this);
	} else {
		// decaf is Decaf. Store it.
		this.decaf = decaf;
	}
	
	// Make a list for storing children.
	this.children = [];
	
	// Ensure that we have localStorage
	if ( ! 'localStorage' in window ) {
		throw "This storage backend can only be used in browsers supporting localStorage."; }
	
	return this;
}

/** Get a value from storage.
 * @param {String} key The key of the item to get.
 * @param {any} [def] The default value. */
Storage.prototype.get = function(key, def) {
	var val = window.localStorage[this.path+key];
	if ( val === undefined || val === null ) { return def; }
	return JSON.parse(val);
}

/** Set a value to storage.
 * @param {String} key The key of the item to set.
 * @param {any} val The value to set it to. */
Storage.prototype.set = function(key, val) {
	if (typeof val === "string") { val = '"'+val+'"'; }
	else { val = JSON.stringify(val); }
	window.localStorage[this.path+key] = val;
}

/** Delete a value in storage.
 * @param {String} key The key of the item to delete. */
Storage.prototype.del = function(key) {
	return delete window.localStorage[this.path+key]; }

/** Get a sub-storage instance for plugins to use.
 * @param {String} name The name of the plugin, for path purposes. */
Storage.prototype.sub = function(name) {
	return new Storage(this, this.path+name); }

/** Get a list of keys at this path. We generally want to avoid this as it's
 *  not the most efficient operation...
 * @returns {Array} A list of all the keys. */
Storage.prototype.keys = function() {
	var out = [], wl = window.localStorage.length, p = this.path;
	for(var i=0;i&lt;wl;i++) {
		var k = window.localStorage.key(i);
		if ( k.indexOf(p) === -1 ) { continue; }
		
		out.push(k.substr(p.length));
	}
	return out;
}
	
/** Change the path of a storage instance, recursively changing all its children
 *  as well.
 * @param {String} path The new path to change it to. */
Storage.prototype.change = function(path) {
	var old = this.path, l = this.children.length;
	this.path = path + '/';
	
	for(var i=0;i&lt;l;i++) {
		// Change the child's path.
		var nw = this.path + this.children[i].path.substr(old.length);
		nw = nw.substr(0, nw.length-1);
		this.children[i].change(nw);
	}
}
	
// Expose this to DecafMUD
DecafMUD.plugins.Storage.standard = Storage;
})(DecafMUD);</pre>
					</div>
				</div>
				
			</div>
		</div>
		<script type="text/javascript">SyntaxHighlighter.all()</script>
	</body>
</html>
